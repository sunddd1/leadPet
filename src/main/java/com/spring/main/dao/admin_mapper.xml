<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC
	"-//mybatis.org//DTD Mapper 3.0//EN"
	"http://mybatis.org/dtd/mybatis-3-mapper.dtd"
>

<!-- 누가 이 XML 을 사용할까? 누구와 연결? -->
<mapper namespace="com.spring.main.dao.AdminDAO">	
<!-- 	<select id="adminCheck" resultType="admin">
		SELECT admin_id FROM admin WHERE admin_id=#{param1}
	</select> -->
	
	<select id="adminList" resultType="admin">
		SELECT * FROM admin ORDER BY reg_date DESC
	</select>
	
	<update id="change">
		UPDATE admin SET password=#{param2} WHERE password=#{param1}  
	</update>
	
	<delete id="adminDelete">
		DELETE FROM admin WHERE admin_id=#{param1}
	</delete>
	
	<select id="idCheck" resultType="int">
		SELECT count(admin_id) FROM admin WHERE admin_id=#{param1}
	</select>
	
	<select id="nickCheck" resultType="int">
		SELECT count(nickname) FROM admin WHERE nickname=#{param1}
	</select>
	
	<insert id="insert">
		INSERT INTO admin(admin_id,nickname,password,reg_date) VALUES(#{param1}, #{param2}, #{param3},SYSDATE)
	</insert>
	
	<select id="search" parameterType="hashMap" resultType="admin">
		SELECT * FROM admin	
		<where>
			<if test="!keyword.equals('') and search == 'id'">admin_id LIKE '%'||#{keyword}||'%'</if>
			<if test="!keyword.equals('') and search == 'nickname'">nickname LIKE '%'||#{keyword}||'%'</if>
		</where>
	</select>
	
	<select id="memberList" resultType="member">
		SELECT * FROM member ORDER BY reg_date DESC
	</select>
	
	<select id="blackList" resultType="member">
		SELECT * FROM member WHERE black='Y' AND withdraw='N' ORDER BY reg_date DESC
	</select>
	
	<select id="withdrawList" resultType="member">
		SELECT * FROM member WHERE black='N' AND withdraw='Y' ORDER BY reg_date DESC
	</select>
	
	<select id="memberSearch" parameterType="hashMap" resultType="member">
		SELECT * FROM member	
		<where>
			<if test="!keyword.equals('') and search == 'id'">id LIKE '%'||#{keyword}||'%'</if>
			<if test="!keyword.equals('') and search == 'nickname'">nickname LIKE '%'||#{keyword}||'%'</if>
		</where>
	</select>
	
	<select id="blackSearch" parameterType="hashMap" resultType="member">
		SELECT * FROM member
		<where>
			<if test="!keyword.equals('') and search == 'id'">id LIKE '%'||#{keyword}||'%'</if>
			<if test="!keyword.equals('') and search == 'nickname'">nickname LIKE '%'||#{keyword}||'%'</if>
		</where>
		 AND black='Y'
	</select>
	
	<select id="withdrawSearch" parameterType="hashMap" resultType="member">
		SELECT * FROM member	
		<where>
			<if test="!keyword.equals('') and search == 'id'">id LIKE '%'||#{keyword}||'%'</if>
			<if test="!keyword.equals('') and search == 'nickname'">nickname LIKE '%'||#{keyword}||'%'</if>
		</where>
		AND withdraw='Y'
	</select>
	 
	 <select id="detailMember" resultType="member">
	 	SELECT id,name,age,gender,email,reg_date,black,withdraw,change_date,nickname,point,grade FROM member WHERE id=#{param1}
	 </select>
	 
	 <update id="restoreWithdraw" parameterType="int">
	 	UPDATE member SET withdraw='N' WHERE id=#{param1}
	 </update>
</mapper>












